{"version":3,"file":"js/972.693800a9.js","mappings":"yKAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,CAAC,OAAS,UAAU,aAAa,WAAW,CAACF,EAAG,MAAM,CAACG,YAAY,MAAMC,GAAG,CAAC,MAAQR,EAAIS,OAAO,CAACT,EAAIU,GAAG,UAAUN,EAAG,MAAM,CAACI,GAAG,CAAC,MAAQR,EAAIW,OAAO,CAACX,EAAIU,GAAG,WAAWN,EAAG,MAAM,CAACI,GAAG,CAAC,MAAQR,EAAIY,OAAO,CAACZ,EAAIU,GAAG,YAAYN,EAAG,QAAQ,CAACE,YAAY,CAAC,MAAQ,SAASN,EAAIa,GAAIb,EAAY,UAAE,SAASc,EAAKC,GAAO,OAAOX,EAAG,KAAK,CAACY,IAAK,QAAUD,GAAQf,EAAIa,GAAG,GAAO,SAASI,EAAKC,GAAQ,OAAOd,EAAG,KAAK,CAACY,IAAK,QAAUE,GAAS,CAAClB,EAAIU,GAAG,IAAIV,EAAImB,GAAGF,GAAM,MAAM,IAAG,EAAE,IAAG,IAAI,EAC1kBG,EAAkB,G,0BCoCtB,wBACA,kBACA,kCAEA,WACA,kCAGA,OACA,OACA,OACA,UACA,UACA,0aAEA,YACA,QACA,UACA,QAEA,EACA,SACA,OACA,eACA,WACA,EACA,OACA,aACA,iBACA,sBAEA,oBACA,yCAIA,kBAEA,WACA,KAEA,6BACA,2BAEA,qBACA,iBACA,uBACA,SACA,CACA,8BACA,aACA,IAEA,aAEA,kBAEA,yBAEA,OACA,YACA,KAEA,uBACA,EAGA,MAEA,EACA,UACA,OACA,wBACA,wCACA,sBACA,wCACA,oBACA,oBACA,qCACA,wCACA,uCACA,0BAEA,EACA,UACA,6BACA,EACA,QACA,aACA,+CACA,mBACA,QACA,oBACA,WACA,IAEA,ICrI8P,I,OCQ1PC,GAAY,OACd,EACAtB,EACAqB,GACA,EACA,KACA,WACA,MAIF,EAAeC,EAAiB,O","sources":["webpack://light-container/./src/views/Clock/index.vue?1938","webpack://light-container/src/views/Clock/index.vue","webpack://light-container/./src/views/Clock/index.vue?2eb6","webpack://light-container/./src/views/Clock/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"cursor\":\"pointer\",\"text-align\":\"center\"}},[_c('div',{staticClass:\"btn\",on:{\"click\":_vm.next}},[_vm._v(\"next\")]),_c('div',{on:{\"click\":_vm.load}},[_vm._v(\"加载pdf\")]),_c('div',{on:{\"click\":_vm.save}},[_vm._v(\"保存年历\")])]),_c('table',{staticStyle:{\"width\":\"100%\"}},_vm._l((_vm.contents),function(line,index){return _c('tr',{key:(\"line-\" + index)},_vm._l((line),function(char,cindex){return _c('td',{key:(\"char-\" + cindex)},[_vm._v(\" \"+_vm._s(char)+\" \")])}),0)}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <!-- <div class=\"clock-container\">\n            <div style=\"text-align: center\">{{year}}</div>\n            <div class=\"clock-box\">\n                <div class=\"pointers\">\n                    <div class=\"year-pointer\" :style=\"{transform: `rotate(${(current_year-15)*6}deg)`}\"></div>\n                    <div class=\"dynasty-pointer\" :style=\"{transform: `rotate(${(current_dynasty-15)*6}deg)`}\"></div>\n                </div>\n                \n                <div class=\"clock-wrapper\">\n                    <div class=\"clock-degree\" v-for=\"item in 60\" :key=\"item\" :style=\"{transform: `rotate(${item*6}deg)`}\">\n                        {{diagrams[item - 1]}}\n                    </div>\n                </div>\n            </div>\n        </div> -->\n        <div style=\"cursor: pointer;text-align: center\">\n            <div class=\"btn\" @click=\"next\">next</div>\n            <div @click=\"load\">加载pdf</div>\n            <div @click=\"save\">保存年历</div>\n        </div>\n\n        <table style=\"width: 100%\">\n            <tr v-for=\"(line, index) in contents\" :key=\"`line-${index}`\">\n                <td v-for=\"(char, cindex) in line\" :key=\"`char-${cindex}`\">\n                    {{char}}\n                </td>\n            </tr>\n        </table>\n    </div>\n</template>\n\n<script>\n    import axios from 'axios'\n    import { API_HOST } from '@/store/config'\n    // import calendar from './calendar.pdf'\n    const pdfjsLib = window.pdfjsLib\n    const pdfjsWorker = window.pdfjsLib\n    pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorker\n    \n    const sleep = ms => {\n        return new Promise(resolve => setTimeout(resolve, ms))\n    }\n\n    export default {\n        data () {\n            return {\n                year: 1984,\n                diagrams: [\n                    '鼎 29','恆 28', '巽 27', '井 26', '蛊 25', '升 24', '讼 23', '困 22', '未济 21', '解 20', '涣 19', '蒙 17', '师 16', '遁 15', '咸 14', '旅 13', '小过 12', '渐 11', '蹇 10', '艮 9', '谦 8', '否 7', '萃 6', '晋 5', '豫 4', '观 3', '比 2', '剥 1', '复 32', '颐 33', '屯 34', '益 35', '震 36', '噬嗑 37', '随 38', '无妄 39', '明夷40', '贲 41', '既济 42', '家人 43', '丰 44', '革 46', '同人 47', '临 48', '损 49', '节 50', '中孚 51', '归妹 52', '睽 53', '兑 54', '履 55', '泰 56', '大畜 57', '需 58', '小畜 59', '大壮 60', '大有 61', '夬 62','姤 31', '大过 30'\n                ],\n                contents: [],\n                line: [],\n                current: 1,\n                total: 1\n            }\n        },\n        methods: {\n            next () {\n                this.current++\n                this.load()\n            },\n            load () {\n                const that = this\n                const task = pdfjsLib.getDocument({\n                    url: '/calendar.pdf'\n                })\n                task.promise.then(pdf => {\n                    this.total = parseInt(pdf._pdfInfo.numPages)\n                    // const total = 2\n                    // let current = 1\n                    \n                    const excute = async () => {\n                        // initial page\n                        const current_page = []\n                        const line = []\n                        // get content\n                        const page = await pdf.getPage(that.current)\n                        const content = await page.getTextContent()\n                        // format content\n                        content.items.forEach(char => {\n                            if (line.length == 16) {\n                                const new_line = line.splice(0, 16)\n                                current_page.push(new_line)\n                            }\n                            if (char.str.replace(/\\s*/g,\"\") != '') {\n                                line.push(char.str)\n                            }\n                        })\n                        that.contents = current_page\n                        // save\n                        that.save(current_page, that.total)\n                        // recycle\n                        if (that.current < that.total) {\n                            // pause\n                            await sleep(5000)\n                            that.current++\n                            excute()\n                        } else {\n                            console.log('finished')\n                        }\n                    }\n                    // load\n                    excute()\n                })\n            },\n            format (line) {\n                return {\n                    sequence: parseInt(line[0]),\n                    samsara: {hex: parseInt(line[2]), cycle: line[1]},\n                    emblem: parseInt(line[3]),\n                    session: {hex: parseInt(line[5]), cycle: line[4]},\n                    term: parseInt(line[6]),\n                    duty: parseInt(line[7]),\n                    fate:  {hex: parseInt(line[9]), cycle: line[8]},\n                    epoch: {hex: parseInt(line[11]), cycle: line[10]},\n                    year: {hex: parseInt(line[13]), cycle: line[12]},\n                    gregorian: parseInt(line[14])\n                }\n            },\n            update (line) {\n                axios.post(`${API_HOST}/timeline`, line)\n            },\n            save (book) {\n                const that = this\n                console.info(this.current, this.total, book.length)\n                book.forEach((line, index) => {\n                    if (index > 0) {\n                        const _line = that.format(line)\n                        that.update(_line)\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style lang=\"less\" scoped>\n    .clock-container {\n        padding: 30px;\n    }\n    .clock-box {\n        border-radius: 100%;\n        position: relative;\n        width: 640px;\n        height: 640px;\n        margin: 0 auto;\n        .year-pointer {\n            position: absolute;\n            width: 320px;\n            height: 2px;\n            background: red;\n            left: 320px;\n            box-sizing: border-box;\n            top: calc((640px - 2px)/2);\n            transform-origin: left center;\n            z-index: 10;\n        }\n        .dynasty-pointer {\n            position: absolute;\n            width: 160px;\n            height: 4px;\n            background: blue;\n            left: 320px;\n            box-sizing: border-box;\n            top: calc((640px - 4px)/2);\n            transform-origin: left center;\n            z-index: 9;\n        }\n    }\n    .clock-wrapper {\n        border-radius: 100%;\n        width: 640px;\n        height: 640px;\n        position: relative;\n        box-sizing: border-box;\n        transform: rotate(-96deg);\n        transform-origin: center center;\n        .clock-degree {\n            position: absolute;\n            left: 320px;\n            width: 320px;\n            box-sizing: border-box;\n            top: calc((640px - 24px)/2);\n            padding: 0 10px;\n            text-align: right;\n            transform-origin: left center;\n            height: 24px;\n            line-height: 24px;\n        }\n    }\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=88ae421a&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=88ae421a&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"88ae421a\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","staticClass","on","next","_v","load","save","_l","line","index","key","char","cindex","_s","staticRenderFns","component"],"sourceRoot":""}